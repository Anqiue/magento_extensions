<?php
 /*
 * Arcanum Dev AwardPoints
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is available through the world-wide-web at this URL:
 * http://opensource.org/licenses/osl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to arcanumdev@wafunotamago.com so we can send you a copy immediately.
 *
 * @category   Magento Sale Extension
 * @package    AwardPoints
 * @copyright  Copyright (c) 2012 Arcanum Dev. Y.K. (http://arcanumdev.wafunotamago.com)
 * @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */
?>
<div class="my-account"><div class="page-title"><h1><?php echo $this->__('Friends Referral') ?></h1></div><?php if($this->getReferrerPoints() || $this->getFriendPoints()):?><div class="fieldset"><h2 class="legend"><?php echo $this->__('Points Information') ?></h2><p class="form-list"><?php if($this->getReferrerPoints()):?><?php echo $this->__('For any first valid order placed by a referred friend you will earn: <strong>%s points</strong>', $this->getReferrerPoints());?><br/><?php endif;?><?php if($this->getFriendPoints()):?><?php echo $this->__('For any first valid order placed by a referred friend he will earn: <strong>%s extra points!</strong>', $this->getFriendPoints());?><?php else:?></p><?php endif;?></p></div><?php endif;?><?php if($this->isAddthis() || $this->isPermanentLink()):?><?php if($this->isPermanentLink()):?><div class="fieldset"><h2 class="legend"><?php echo $this->__('Your Permanent Link') ?></h2><p class="form-list"><?php echo $this->__('Share the following link with your friends') ?>:<br/><strong><?php echo $this->getReferringUrl() ?></strong></p></div><?php endif;?><?php if($this->isAddthis()):?><div class="fieldset"><h2 class="legend"><?php echo $this->__('Share Referring link') ?></h2><ul class="form-list"><li class="fields"><div class="field"><label for="name"><?php echo $this->__('Title') ?></label><div class="input-box"><input onkeyup="arcanumReinitializeAddThis();" type="text" name="arcanum-share-title" id="arcanum-share-title" value="<?php echo $this->__('Great deals here!');?>" class="input-text" /></div></div></li><li class="fields"><div class="field"><a class="addthis_counter addthis_pill_style" id="arcanum-post-share" addthis:url="<?php echo $this->getReferringUrl();?>" addthis:title="<?php echo $this->__('Great deals here!');?>" addthis:description="<?php echo $this->__('Visit this for great deals!');?>"></a></div></li></ul></div><script type="text/javascript">function arcanumReinitializeAddThis(){if (window.addthis){$('arcanum-post-share').writeAttribute('addthis:title', $('arcanum-share-title').value);window.addthis.ost = 0;window.addthis.ready();}addthis.button('#arcanum-post-share');}</script><?php endif;?><?php endif;?><?php echo $this->getMessagesBlock()->getGroupedHtml() ?><div class="fieldset"><h2 class="legend"><?php echo $this->__('Refer a Friend') ?></h2><form class="form-list" action="<?php echo $this->getUrl('awardpoints/index/referral/') ?>" method="post" id="form-validate"><fieldset class="fields"><input type="hidden" value="Il1NwrpfsCuSmp03" name="form_key"/><ul><li><div class="field"><label for="name" class="required"><em>*</em><?php echo $this->__('Name') ?> <span class="required"></label><div class="input-box"><input type="text" name="name" value="" title="<?php echo $this->__('Name') ?>" class="required-entry input-text" id="name" /></div></div></li><li><div class="field"><label for="email" class="required"><em>*</em><?php echo $this->__('Email Address') ?></label><div class="input-box"><input type="text" name="email" id="email" title="<?php echo $this->__('Email Address') ?>" value="" class="required-entry input-text" /></div></div><br/><div class="buttons-set"><p class="required"><?php echo $this->__('* Required Fields') ?></p><input type="text" name="hideit" id="hideit" value="" style="display:none !important;" /><button type="submit" title="<?php echo $this->__('Submit') ?>" class="button"><span><span><?php echo $this->__('Submit') ?></span></span></button></div></li></ul></fieldset></form></div><script type="text/javascript">var dataForm = new VarienForm('form-validate', true);</script><?php $_referred = $this->getReferred();?><div class="fieldset"><h2 class="legend"><?php echo $this->__('Your Referral History') ?></h2><?php if($_referred->getSize()): ?><?php echo $this->getPagerHtml() ?><table cellspacing="0" class="data-table" id="referred-friends-table"><thead><tr><th><?php echo $this->__('Full Name') ?></th><th><?php echo $this->__('Email') ?></th><!--<th><?php echo $this->__('Registered') ?>?</th>--><th><?php echo $this->__('First Order') ?>?</th></tr></thead><tbody><?php $_odd = ''; ?><?php foreach ($_referred as $_friend): ?><tr><td><?php echo $_friend->getAwardpoints_referral_name() ?></td><td><?php echo $_friend->getAwardpoints_referral_email() ?></td><!--<td><?php echo $_friend->getAwardpoints_referral_child_id() ? $this->__('yes') : $this->__('no') ?></td>--><td class="a-right"><?php echo $_friend->getAwardpoints_referral_status() ? $this->__('yes') : $this->__('no') ?></td></tr><?php endforeach; ?></tbody></table><?php echo $this->getPagerHtml() ?><?php else: ?><p><?php echo $this->__('You did not made any friends referral yet.'); ?></p><?php endif ?></div></div>